# CozyMind 架构设计

## 系统架构

```
┌─────────────────────────────────────────────┐
│              GUI (用户界面)                   │
│    (Tauri/Electron/Web)                     │
└──────────────────┬──────────────────────────┘
                   │
                   │ HTTP/WebSocket/IPC
                   │
┌──────────────────┴──────────────────────────┐
│          AI-Core (AI辅助中枢)                │
│    (Rust + actix-web)                       │
│                                             │
│  - AI模型调用                                │
│  - 业务逻辑处理                               │
│  - HTTP API服务 (端口9800)                   │
└──────────────────┬──────────────────────────┘
                   │
                   │ FFI/gRPC/REST
                   │
┌──────────────────┴──────────────────────────┐
│       Rust-Models (通用模型包)               │
│    (Rust Library)                           │
│                                             │
│  - 数据结构定义                               │
│  - 通用算法                                   │
│  - 序列化/反序列化                            │
└─────────────────────────────────────────────┘
```

## 模块间通信

### GUI <-> AI-Core
- **方式**: HTTP REST API 或 WebSocket
- **数据格式**: JSON
- **用途**: 用户操作、AI响应

### AI-Core <-> Rust-Models
- **方式**: FFI (Foreign Function Interface) 或 gRPC
- **数据格式**: 结构化数据 / Protobuf
- **用途**: 调用Rust实现的高性能算法

## 数据流

1. 用户在GUI中进行操作
2. GUI发送请求到AI-Core
3. AI-Core处理请求，可能调用Rust-Models
4. AI-Core返回结果给GUI
5. GUI展示结果给用户

## 技术选型建议

### GUI模块
- **使用**: Tauri 1.5 + Taro 3.6 + React 18
  - 优点: 轻量级、安全、跨端开发（桌面+小程序）
  - 特点: 提供环境配置界面，可配置AI-Core和Ollama接口

### AI-Core模块
- **使用**: Rust + actix-web
  - 优点: 高性能、内存安全、异步处理
  - 特点: 监听9800端口，提供RESTful API

### Rust-Models模块
- **推荐**: Rust + Serde
  - 优点: 高性能、内存安全、类型安全
  - 缺点: 学习曲线较陡

## 部署方案

- **开发环境**: 本地运行各个模块
- **生产环境**: 
  - GUI: 打包为桌面应用
  - AI-Core: Docker容器部署
  - Rust-Models: 编译为动态库或静态链接

